{"version":3,"sources":["../src/renderer.js"],"names":["_","moment","kbn","TableRenderer","panel","table","isUtc","sanitize","templateSrv","initColumns","formatters","colorState","colIndex","columns","length","column","title","text","i","styles","style","regex","stringToJsRegex","pattern","match","alias","replace","createColumnFormatter","value","thresholds","colors","first","v","undefined","isArray","join","escape","defaultCellFormatter","type","isString","isNaN","parseInt","date","utc","format","dateFormat","mappingType","valueMaps","map","Number","setColorState","rangeMaps","from","to","valueFormatter","valueFormats","unit","decimals","colorMode","numericValue","getColorForValue","rowIndex","scopedVars","cellVariable","row","rows","columnIndex","addWidthHack","formatColumnValue","cellStyle","textStyle","cellClasses","cellClass","cell","push","columnHtml","hidden","preserveFormat","link","renderRowVariables","cellLink","linkUrl","encodeURIComponent","cellLinkTooltip","linkTooltip","cellTarget","linkTargetBlank","filterable","page","pageSize","startPos","endPos","Math","min","html","rowClasses","rowID","rowClass","y","cellHtml","rowStyle","renderCell","newRow"],"mappings":"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","file":"renderer.js","sourcesContent":["import _ from 'lodash';\nimport moment from 'moment';\nimport kbn from 'app/core/utils/kbn';\n\nexport class TableRenderer {\n\n  constructor( panel, table, isUtc, sanitize, templateSrv) {\n    this.panel = panel;\n    this.table = table;\n    this.isUtc = isUtc;\n    this.sanitize = sanitize;\n    this.templateSrv = templateSrv;\n    this.initColumns();\n  }\n\n  setTable(table) {\n    this.table = table;\n    this.initColumns();\n  }\n\n  initColumns() {\n    this.formatters = [];\n    this.colorState = {};\n    for (let colIndex = 0; colIndex < this.table.columns.length; colIndex++) {\n      const column = this.table.columns[colIndex];\n      column.title = column.text;\n\n      for (let i = 0; i < this.panel.styles.length; i++) {\n        const style = this.panel.styles[i];\n\n        const regex = kbn.stringToJsRegex(style.pattern);\n        if (column.text.match(regex)) {\n          column.style = style;\n\n          if (style.alias) {\n            column.title = column.text.replace(regex, style.alias);\n          }\n\n          break;\n        }\n      }\n\n      this.formatters[colIndex] = this.createColumnFormatter(column);\n    }\n  }\n\n  getColorForValue(value, style) {\n    if (!style.thresholds) {\n      return null;\n    }\n    for (let i = style.thresholds.length; i > 0; i--) {\n      if (value >= style.thresholds[i - 1]) {\n        return style.colors[i];\n      }\n    }\n    return _.first(style.colors);\n  }\n\n  defaultCellFormatter(v, style) {\n    if (v === null || v === void 0 || v === undefined) {\n      return '';\n    }\n\n    if (_.isArray(v)) {\n      v = v.join(', ');\n    }\n\n    if (style && style.sanitize) {\n      return this.sanitize(v);\n    } else {\n      return _.escape(v);\n    }\n  }\n\n  createColumnFormatter(column) {\n    if (!column.style) {\n      return this.defaultCellFormatter;\n    }\n\n    if (column.style.type === 'hidden') {\n      return v => {\n        return undefined;\n      };\n    }\n\n    if (column.style.type === 'date') {\n      return v => {\n        if (v === undefined || v === null) {\n          return '-';\n        }\n\n        if (_.isArray(v)) {\n          v = v[0];\n        }\n\n        // if is an epoch (numeric string and len > 12)\n        if (_.isString(v) && !isNaN(v) && v.length > 12) {\n          v = parseInt(v, 10);\n        }\n\n        let date = moment(v);\n\n        if (this.isUtc) {\n          date = date.utc();\n        }\n        return date.format(column.style.dateFormat);\n      };\n    }\n\n    if (column.style.type === 'string') {\n      return v => {\n        if (_.isArray(v)) {\n          v = v.join(', ');\n        }\n\n        const mappingType = column.style.mappingType || 0;\n\n        if (mappingType === 1 && column.style.valueMaps) {\n          for (let i = 0; i < column.style.valueMaps.length; i++) {\n            const map = column.style.valueMaps[i];\n\n            if (v === null) {\n              if (map.value === 'null') {\n                return map.text;\n              }\n              continue;\n            }\n\n            // Allow both numeric and string values to be mapped\n            if ((!_.isString(v) && Number(map.value) === Number(v)) || map.value === v) {\n              this.setColorState(v, column.style);\n              return this.defaultCellFormatter(map.text, column.style);\n            }\n          }\n        }\n\n        if (mappingType === 2 && column.style.rangeMaps) {\n          for (let i = 0; i < column.style.rangeMaps.length; i++) {\n            const map = column.style.rangeMaps[i];\n\n            if (v === null) {\n              if (map.from === 'null' && map.to === 'null') {\n                return map.text;\n              }\n              continue;\n            }\n\n            if (Number(map.from) <= Number(v) && Number(map.to) >= Number(v)) {\n              this.setColorState(v, column.style);\n              return this.defaultCellFormatter(map.text, column.style);\n            }\n          }\n        }\n\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        this.setColorState(v, column.style);\n        return this.defaultCellFormatter(v, column.style);\n      };\n    }\n\n    if (column.style.type === 'number') {\n      const valueFormatter = kbn.valueFormats[column.unit || column.style.unit];\n\n      return v => {\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        if (_.isString(v) || _.isArray(v)) {\n          return this.defaultCellFormatter(v, column.style);\n        }\n\n        this.setColorState(v, column.style);\n        return valueFormatter(v, column.style.decimals, null);\n      };\n    }\n\n    return value => {\n      return this.defaultCellFormatter(value, column.style);\n    };\n  }\n\n  setColorState(value, style) {\n    if (!style.colorMode) {\n      return;\n    }\n\n    if (value === null || value === void 0 || _.isArray(value)) {\n      return;\n    }\n\n    const numericValue = Number(value);\n    if (isNaN(numericValue)) {\n      return;\n    }\n\n    this.colorState[style.colorMode] = this.getColorForValue(numericValue, style);\n  }\n\n  renderRowVariables(rowIndex) {\n    const scopedVars = {};\n    let cellVariable;\n    const row = this.table.rows[rowIndex];\n    for (let i = 0; i < row.length; i++) {\n      cellVariable = `__cell_${i}`;\n      scopedVars[cellVariable] = { value: row[i] };\n    }\n    return scopedVars;\n  }\n\n  formatColumnValue(colIndex, value) {\n    return this.formatters[colIndex] ? this.formatters[colIndex](value) : value;\n  }\n\n  renderCell(columnIndex, rowIndex, value, addWidthHack = false) {\n    value = this.formatColumnValue(columnIndex, value);\n\n    const column = this.table.columns[columnIndex];\n    let cellStyle = '';\n    let textStyle = '';\n    const cellClasses = [];\n    let cellClass = '';\n\n    if (this.colorState.cell) {\n      cellStyle = ' style=\"background-color:' + this.colorState.cell + '\"';\n      cellClasses.push('table-panel-color-cell');\n      this.colorState.cell = null;\n    } else if (this.colorState.value) {\n      textStyle = ' style=\"color:' + this.colorState.value + '\"';\n      this.colorState.value = null;\n    }\n    // because of the fixed table headers css only solution\n    // there is an issue if header cell is wider the cell\n    // this hack adds header content to cell (not visible)\n    let columnHtml = '';\n    if (addWidthHack) {\n      columnHtml = '<div class=\"table-panel-width-hack\">' + this.table.columns[columnIndex].title + '</div>';\n    }\n\n    if (value === undefined) {\n      cellStyle = ' style=\"display:none;\"';\n      column.hidden = true;\n    } else {\n      column.hidden = false;\n    }\n\n    if (column.hidden === true) {\n      return '';\n    }\n\n    if (column.style && column.style.preserveFormat) {\n      cellClasses.push('table-panel-cell-pre');\n    }\n\n    if (column.style && column.style.link) {\n      // Render cell as link\n      const scopedVars = this.renderRowVariables(rowIndex);\n      scopedVars['__cell'] = { value: value };\n\n      const cellLink = this.templateSrv.replace(column.style.linkUrl, scopedVars, encodeURIComponent);\n      const cellLinkTooltip = this.templateSrv.replace(column.style.linkTooltip, scopedVars);\n      const cellTarget = column.style.linkTargetBlank ? '_blank' : '';\n\n      cellClasses.push('table-panel-cell-link');\n\n      columnHtml += `\n        <a href=\"${cellLink}\" target=\"${cellTarget}\" data-link-tooltip data-original-title=\"${cellLinkTooltip}\" data-placement=\"right\"${textStyle}>\n          ${value}\n        </a>\n      `;\n    } else {\n      columnHtml += value;\n    }\n\n    if (column.filterable) {\n      cellClasses.push('table-panel-cell-filterable');\n      columnHtml += `\n        <a class=\"table-panel-filter-link\" data-link-tooltip data-original-title=\"Filter out value\" data-placement=\"bottom\"\n           data-row=\"${rowIndex}\" data-column=\"${columnIndex}\" data-operator=\"!=\">\n          <i class=\"fa fa-search-minus\"></i>\n        </a>\n        <a class=\"table-panel-filter-link\" data-link-tooltip data-original-title=\"Filter for value\" data-placement=\"bottom\"\n           data-row=\"${rowIndex}\" data-column=\"${columnIndex}\" data-operator=\"=\">\n          <i class=\"fa fa-search-plus\"></i>\n        </a>`;\n    }\n\n    if (cellClasses.length) {\n      cellClass = ' class=\"' + cellClasses.join(' ') + '\"';\n    }\n\n    columnHtml = '<td' + cellClass + cellStyle + textStyle + '>' + columnHtml + '</td>';\n    return columnHtml;\n  }\n\n  render(page) {\n    const pageSize = this.panel.pageSize || 100;\n    const startPos = page * pageSize;\n    const endPos = Math.min(startPos + pageSize, this.table.rows.length);\n    let html = '';\n    const rowClasses = ['tr-affect'];\n    const rowID = ' id=\"master-data-material-tr\"'\n    let rowClass = '';\n\n    for (let y = startPos; y < endPos; y++) {\n      const row = this.table.rows[y];\n      let cellHtml = '';\n      let rowStyle = '';\n      \n      for (let i = 0; i < this.table.columns.length; i++) {\n        cellHtml += this.renderCell(i, y, row[i], y === startPos);\n      }\n\n      if (this.colorState.row) {\n        rowStyle = ' style=\"background-color:' + this.colorState.row + ';color:black;\"';\n        rowClasses.push('table-panel-color-row');\n        this.colorState.row = null;\n      }\n\n      if (rowClasses.length) {\n        rowClass = ' class=\"' + rowClasses.join(' ') + '\"';\n      }\n\n      html += '<tr ' + rowClass + rowStyle + rowID + '>' + cellHtml + '</tr>';\n    }\n\n    return html;\n  }\n\n  render_values() {\n    const rows = [];\n\n    for (let y = 0; y < this.table.rows.length; y++) {\n      const row = this.table.rows[y];\n      const newRow = [];\n      for (let i = 0; i < this.table.columns.length; i++) {\n        newRow.push(this.formatColumnValue(i, row[i]));\n      }\n      rows.push(newRow);\n    }\n    return {\n      columns: this.table.columns,\n      rows: rows,\n    };\n  }\n}\n"]}